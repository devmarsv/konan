<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE mapper PUBLIC
"-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="boardMapper">

	<resultMap id="resultBoard" type="Board">
		<id property="board_num" column="board_num" />
		<result property="board_writer" column="board_writer" />
		<result property="board_title" column="board_title" />
		<result property="board_content" column="board_content" />
		<result property="board_original_filename" column="board_original_filename" />
		<result property="board_rename_filename" column="board_rename_filename" />
		<result property="board_readcount" column="board_readcount" />
		<result property="board_date" column="board_date" />
		<result property="board_category" column="board_category" />
	</resultMap>

	<select id="selectList" parameterType="hashMap"
		resultType="Board" resultMap="resultBoard">
		<!-- 전체 -->
		select * from(select rownum rnum, board_num, board_writer, board_title,
                        board_content, board_original_filename, board_rename_filename,
                        board_readcount, board_date, board_category
                        from board1
			<if test="cg=='all'">
				where
				board_title like '%' || #{bar} || '%' or
				board_content like '%' || #{bar} || '%'
			</if>
			<if test="cg=='title'">
				where
				board_title like '%' || #{bar} || '%'
			</if>
			<if test="cg=='content'">
				where
				board_content like '%' || #{bar} || '%'
			</if>
		)where
		<![CDATA[rnum >= #{startRow} and rnum <= #{endRow}]]>
		order by board_num asc
	</select>


	<select id="listCount" resultType="_int">
		select count(*) from board1
	</select>

	<!-- 조회수 -->
	<update id="addReadCount" parameterType="_int">
		update board1 set
		board_readcount = board_readcount + 1 where board_num = #{board_num}
	</update>

	<!--상세보기 -->
	<select id="selectBoard" parameterType="hashMap"
		resultType="Board" resultMap="resultBoard">
		select * from board1 where board_num =
		#{board_num}
	</select>


	<!-- 글쓰기 -->
	<insert id="insertNotice" parameterType="Notice">
		insert into notice
		values ((select max(noticeno) from notice) + 1,
		#{noticetitle}, default, #{noticewriter}, #{noticecontent}, noticereadcount,
		#{original_filepath, jdbcType=VARCHAR}, #{rename_filepath, jdbcType=VARCHAR})
	</insert>

	<!-- <select id="selectTop3List" resultType="Notice" resultMap="resultNotice"> 
		<![CDATA[select * from (select rownum rnum, noticeno, noticetitle, noticewriter, 
		noticedate from (select * from notice order by noticedate desc)) where rnum 
		>= 1 and rnum <= 3 ]]> </select> IF <update id="updateNotice" parameterType="Notice"> 
		update notice set noticetitle = #{noticeTitle}, noticecontent = #{noticeContent} 
		<if test="originalFilePath != null"> , original_filepath = #{originalFilePath}, 
		rename_filepath = #{renameFilePath} where noticeno = #{noticeNo} </if> where 
		noticeno = #{noticeNo} </update> <delete id="deleteNotice" parameterType="_int"> 
		delete from notice where noticeno = #{noticeNo} </delete> <select id="selectSearchDate" 
		parameterType="notice.model.vo.SearchDate" resultType="Notice" resultMap="resultNotice"> 
		select * from notice where noticedate between #{begin} and #{end} order by 
		noticeno desc </select> <select id="selectSearchWriter" parameterType="string" 
		resultType="Notice" resultMap="resultNotice"> select * from notice where 
		noticewriter like '%' || #{noticeWriter} || '%' order by noticeno desc </select> -->

</mapper>
